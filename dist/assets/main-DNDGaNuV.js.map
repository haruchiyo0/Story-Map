{"version":3,"file":"main-DNDGaNuV.js","sources":["../../src/scripts/utils/config.js","../../src/scripts/data/api.js","../../src/scripts/utils/mapUtils.js","../../src/scripts/utils/validation.js","../../src/scripts/utils/index.js","../../node_modules/idb/build/index.js","../../src/scripts/utils/idb.js","../../src/scripts/pages/home/home-page.js","../../src/scripts/utils/sync-helper.js","../../src/scripts/pages/add/add-page.js","../../src/scripts/pages/auth/auth-page.js","../../src/scripts/pages/favorite/favorite-page.js","../../src/scripts/routes/routes.js","../../src/scripts/routes/url-parser.js","../../src/scripts/utils/notification-helper.js","../../src/scripts/pages/app.js","../../src/scripts/index.js"],"sourcesContent":["const CONFIG = {\n  BASE_URL: 'https://story-api.dicoding.dev/v1',\n};\n\nexport default CONFIG;\n","import CONFIG from \"../utils/config\";\n\nconst ENDPOINTS = {\n  REGISTER: `${CONFIG.BASE_URL}/register`,\n  LOGIN: `${CONFIG.BASE_URL}/login`,\n  STORIES: `${CONFIG.BASE_URL}/stories`,\n  ADD_STORY_GUEST: `${CONFIG.BASE_URL}/stories/guest`,\n  SUBSCRIBE: `${CONFIG.BASE_URL}/notifications/subscribe`,\n  UNSUBSCRIBE: `${CONFIG.BASE_URL}/notifications/subscribe`,\n};\n\nconst getAuthHeader = () => {\n  const token = localStorage.getItem(\"token\");\n  return token ? { Authorization: `Bearer ${token}` } : {};\n};\n\nexport async function register(user) {\n  const response = await fetch(ENDPOINTS.REGISTER, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(user),\n  });\n  const data = await response.json();\n  if (data.error) throw new Error(data.message);\n  return data;\n}\n\nexport async function login(user) {\n  const response = await fetch(ENDPOINTS.LOGIN, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(user),\n  });\n  const data = await response.json();\n  if (data.error) throw new Error(data.message);\n  localStorage.setItem(\"token\", data.loginResult.token);\n  localStorage.setItem(\"name\", data.loginResult.name);\n  return data;\n}\n\nexport async function getStories() {\n  const response = await fetch(`${ENDPOINTS.STORIES}?location=1`, {\n    headers: getAuthHeader(),\n  });\n  const data = await response.json();\n  if (data.error) throw new Error(data.message);\n  return data.listStory;\n}\n\nexport async function addStory(story) {\n  const formData = new FormData();\n  formData.append(\"description\", `${story.name}: ${story.description}`);\n  formData.append(\"photo\", story.photo);\n  if (story.lat) formData.append(\"lat\", story.lat);\n  if (story.lon) formData.append(\"lon\", story.lon);\n  const response = await fetch(ENDPOINTS.STORIES, {\n    method: \"POST\",\n    headers: getAuthHeader(),\n    body: formData,\n  });\n  const data = await response.json();\n  if (data.error) throw new Error(data.message);\n  return data;\n}\n\nexport async function subscribePushNotification({ endpoint, keys: { p256dh, auth } }) {\n    const data = JSON.stringify({\n      endpoint,\n      keys: { p256dh, auth },\n    });\n    const fetchResponse = await fetch(ENDPOINTS.SUBSCRIBE, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${localStorage.getItem('token')}`,\n      },\n      body: data,\n    });\n    const json = await fetchResponse.json();\n    return {\n      ...json,\n      ok: fetchResponse.ok,\n  };\n}\n\nexport async function unsubscribePushNotification({ endpoint }) {\n    const data = JSON.stringify({ endpoint });\n    const fetchResponse = await fetch(ENDPOINTS.UNSUBSCRIBE, {\n      method: 'DELETE',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${localStorage.getItem('token')}`,\n      },\n      body: data,\n    });\n    const json = await fetchResponse.json();\n    return {\n      ...json,\n      ok: fetchResponse.ok,\n  };\n}","import L from \"leaflet\";\nimport markerIconPng from 'leaflet/dist/images/marker-icon.png';\nimport markerShadowPng from 'leaflet/dist/images/marker-shadow.png';\n\nlet map,\n  markers = [];\n\nexport function initMap(containerId, stories) {\n  map = L.map(containerId).setView([0, 0], 2);\n  L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n    attribution: \"¬© OpenStreetMap\",\n  }).addTo(map);\n\n  const satellite = L.tileLayer(\n    \"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\",\n    {\n      attribution: \"¬© Esri\",\n    },\n  );\n\n  L.control\n    .layers({\n      OpenStreetMap: L.tileLayer(\n        \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n      ),\n      Satellite: satellite,\n    })\n    .addTo(map);\n\n  addMarkers(stories);\n}\n\nexport function addMarkers(stories) {\n  stories.forEach((story) => {\n    const marker = L.marker([story.lat, story.lon]).addTo(map);\n    marker.bindPopup(`\n      <div style=\"width: 200px;\">\n        <img src=\"${story.photoUrl}\" alt=\"${story.name}\" style=\"width: 100%; height: 120px; object-fit: cover; border-radius: 5px;\">\n        <h3>${story.name}</h3>\n        <p>${story.description}</p>\n      </div>\n    `);\n    markers.push({ marker, story });\n  });\n}\n\nexport function filterMarkers(query) {\n  markers.forEach(({ marker, story }) => {\n    if (story.name.toLowerCase().includes(query.toLowerCase())) {\n      map.addLayer(marker);\n    } else {\n      map.removeLayer(marker);\n    }\n  });\n}\n\nexport function initMapForLocation(containerId, callback) {\n  const map = L.map(containerId).setView([0, 0], 2);\n  L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\").addTo(map);\n  map.on(\"click\", (e) => {\n    console.log(\"Map clicked:\", e.latlng);\n    callback(e.latlng.lat, e.latlng.lng);\n  });\n}\n","export function validateForm(data) {\n  let isValid = true;\n  document.getElementById(\"name-error\").textContent = \"\";\n  document.getElementById(\"desc-error\").textContent = \"\";\n  document.getElementById(\"photo-error\").textContent = \"\";\n  if (!data.name) {\n    document.getElementById(\"name-error\").textContent = \"Name is required.\";\n    isValid = false;\n  }\n  if (!data.description) {\n    document.getElementById(\"desc-error\").textContent =\n      \"Description is required.\";\n    isValid = false;\n  }\n  if (!data.photo) {\n    document.getElementById(\"photo-error\").textContent = \"Photo is required.\";\n    isValid = false;\n  }\n  return isValid;\n}\n","export function showFormattedDate(date, locale = \"en-US\", options = {}) {\n  return new Date(date).toLocaleDateString(locale, {\n    year: \"numeric\",\n    month: \"long\",\n    day: \"numeric\",\n    ...options,\n  });\n}\n\nexport function sleep(time = 1000) {\n  return new Promise((resolve) => setTimeout(resolve, time));\n}\n\nexport * from \"./mapUtils.js\";\nexport * from \"./validation.js\";\n\nexport function isServiceWorkerAvailable() {\n  return 'serviceWorker' in navigator;\n}\n\nexport async function registerServiceWorker() {\n  if (!isServiceWorkerAvailable()) {\n    console.log('Service Worker API not supported');\n    return null;\n  }\n\n  try {\n    // Unregister existing service workers first (untuk development)\n    const registrations = await navigator.serviceWorker.getRegistrations();\n    for (const registration of registrations) {\n      await registration.unregister();\n      console.log('Unregistered old service worker');\n    }\n\n    // Wait a bit for cleanup\n    await sleep(100);\n\n    // Register new service worker\n    const registration = await navigator.serviceWorker.register('/sw.js', {\n      scope: '/',\n      updateViaCache: 'none'\n    });\n\n    console.log('‚úÖ Service Worker registered successfully');\n    console.log('Scope:', registration.scope);\n    console.log('State:', registration.installing || registration.waiting || registration.active);\n\n    // Wait for service worker to be ready\n    await navigator.serviceWorker.ready;\n    console.log('‚úÖ Service Worker is ready');\n\n    // Handle updates\n    registration.addEventListener('updatefound', () => {\n      const newWorker = registration.installing;\n      console.log('üîÑ New Service Worker found, installing...');\n\n      newWorker.addEventListener('statechange', () => {\n        console.log('Service Worker state:', newWorker.state);\n        \n        if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\n          // New version available\n          if (confirm('New version available! Reload to update?')) {\n            newWorker.postMessage({ type: 'SKIP_WAITING' });\n            window.location.reload();\n          }\n        }\n      });\n    });\n\n    // Listen for controlling service worker changes\n    navigator.serviceWorker.addEventListener('controllerchange', () => {\n      console.log('Controller changed, reloading...');\n      window.location.reload();\n    });\n\n    // Check for updates periodically (every hour)\n    setInterval(() => {\n      registration.update();\n      console.log('Checking for Service Worker updates...');\n    }, 60 * 60 * 1000);\n\n    return registration;\n\n  } catch (error) {\n    console.error('‚ùå Service Worker registration failed:', error);\n    return null;\n  }\n}\n\n// Helper untuk mengecek koneksi online/offline\nexport function isOnline() {\n  return navigator.onLine;\n}\n\n// Event listeners untuk online/offline status\nif (typeof window !== 'undefined') {\n  window.addEventListener('online', () => {\n    console.log('üåê App is online');\n    hideOfflineIndicator();\n    \n    // Trigger sync jika ada data offline\n    if (isServiceWorkerAvailable()) {\n      navigator.serviceWorker.ready.then(registration => {\n        if ('sync' in registration) {\n          registration.sync.register('sync-stories');\n        }\n      });\n    }\n  });\n\n  window.addEventListener('offline', () => {\n    console.log('üì° App is offline');\n    showOfflineIndicator();\n  });\n\n  // Check initial state\n  if (!navigator.onLine) {\n    showOfflineIndicator();\n  }\n}\n\nfunction showOfflineIndicator() {\n  const existingIndicator = document.getElementById('offline-indicator');\n  if (existingIndicator) return;\n\n  const indicator = document.createElement('div');\n  indicator.id = 'offline-indicator';\n  indicator.style.cssText = `\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    background: linear-gradient(135deg, #e74c3c, #c0392b);\n    color: white;\n    padding: 12px;\n    text-align: center;\n    z-index: 10000;\n    font-weight: bold;\n    box-shadow: 0 2px 10px rgba(0,0,0,0.2);\n    animation: slideDown 0.3s ease;\n  `;\n  indicator.textContent = 'üì° You are offline - Some features may be limited';\n  document.body.appendChild(indicator);\n}\n\nfunction hideOfflineIndicator() {\n  const indicator = document.getElementById('offline-indicator');\n  if (indicator) {\n    indicator.style.animation = 'slideUp 0.3s ease';\n    setTimeout(() => indicator.remove(), 300);\n  }\n}\n\n// Add CSS animations\nif (typeof document !== 'undefined') {\n  const style = document.createElement('style');\n  style.textContent = `\n    @keyframes slideDown {\n      from {\n        transform: translateY(-100%);\n      }\n      to {\n        transform: translateY(0);\n      }\n    }\n    \n    @keyframes slideUp {\n      from {\n        transform: translateY(0);\n      }\n      to {\n        transform: translateY(-100%);\n      }\n    }\n\n    @keyframes slideIn {\n      from {\n        transform: translateX(100%);\n        opacity: 0;\n      }\n      to {\n        transform: translateX(0);\n        opacity: 1;\n      }\n    }\n\n    @keyframes slideOut {\n      from {\n        transform: translateX(0);\n        opacity: 1;\n      }\n      to {\n        transform: translateX(100%);\n        opacity: 0;\n      }\n    }\n  `;\n  document.head.appendChild(style);\n}","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst transactionDoneMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    // This mapping exists in reverseTransformCache but doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(this.request);\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nconst advanceMethodProps = ['continue', 'continuePrimaryKey', 'advance'];\nconst methodMap = {};\nconst advanceResults = new WeakMap();\nconst ittrProxiedCursorToOriginalProxy = new WeakMap();\nconst cursorIteratorTraps = {\n    get(target, prop) {\n        if (!advanceMethodProps.includes(prop))\n            return target[prop];\n        let cachedFunc = methodMap[prop];\n        if (!cachedFunc) {\n            cachedFunc = methodMap[prop] = function (...args) {\n                advanceResults.set(this, ittrProxiedCursorToOriginalProxy.get(this)[prop](...args));\n            };\n        }\n        return cachedFunc;\n    },\n};\nasync function* iterate(...args) {\n    // tslint:disable-next-line:no-this-assignment\n    let cursor = this;\n    if (!(cursor instanceof IDBCursor)) {\n        cursor = await cursor.openCursor(...args);\n    }\n    if (!cursor)\n        return;\n    cursor = cursor;\n    const proxiedCursor = new Proxy(cursor, cursorIteratorTraps);\n    ittrProxiedCursorToOriginalProxy.set(proxiedCursor, cursor);\n    // Map this double-proxy back to the original, so other cursor methods work.\n    reverseTransformCache.set(proxiedCursor, unwrap(cursor));\n    while (cursor) {\n        yield proxiedCursor;\n        // If one of the advancing methods was not called, call continue().\n        cursor = await (advanceResults.get(proxiedCursor) || cursor.continue());\n        advanceResults.delete(proxiedCursor);\n    }\n}\nfunction isIteratorProp(target, prop) {\n    return ((prop === Symbol.asyncIterator &&\n        instanceOfAny(target, [IDBIndex, IDBObjectStore, IDBCursor])) ||\n        (prop === 'iterate' && instanceOfAny(target, [IDBIndex, IDBObjectStore])));\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get(target, prop, receiver) {\n        if (isIteratorProp(target, prop))\n            return iterate;\n        return oldTraps.get(target, prop, receiver);\n    },\n    has(target, prop) {\n        return isIteratorProp(target, prop) || oldTraps.has(target, prop);\n    },\n}));\n\nexport { deleteDB, openDB, unwrap, wrap };\n","import { openDB } from 'idb';\r\n\r\nconst DATABASE_NAME = 'storymap';\r\nconst DATABASE_VERSION = 1;\r\nconst STORIES_STORE = 'saved-stories';\r\nconst PENDING_STORE = 'pending-stories';\r\n\r\nconst dbPromise = openDB(DATABASE_NAME, DATABASE_VERSION, {\r\n  upgrade(database) {\r\n    // Object store untuk stories yang disimpan (dari API)\r\n    if (!database.objectStoreNames.contains(STORIES_STORE)) {\r\n      const storyStore = database.createObjectStore(STORIES_STORE, {\r\n        keyPath: 'id',\r\n      });\r\n      // Index untuk search dan filter\r\n      storyStore.createIndex('name', 'name', { unique: false });\r\n      storyStore.createIndex('createdAt', 'createdAt', { unique: false });\r\n    }\r\n\r\n    // Object store untuk stories yang menunggu sync (offline)\r\n    if (!database.objectStoreNames.contains(PENDING_STORE)) {\r\n      database.createObjectStore(PENDING_STORE, {\r\n        keyPath: 'tempId',\r\n        autoIncrement: true\r\n      });\r\n    }\r\n  },\r\n});\r\n\r\nconst Database = {\r\n  // === CRUD Operations untuk Saved Stories ===\r\n  \r\n  async saveStory(story) {\r\n    if (!story || !story.id) {\r\n      throw new Error('Story must have an id');\r\n    }\r\n    return (await dbPromise).put(STORIES_STORE, story);\r\n  },\r\n\r\n  async getStoryById(id) {\r\n    if (!id) {\r\n      throw new Error('id is required');\r\n    }\r\n    return (await dbPromise).get(STORIES_STORE, id);\r\n  },\r\n\r\n  async getAllStories() {\r\n    return (await dbPromise).getAll(STORIES_STORE);\r\n  },\r\n\r\n  async deleteStory(id) {\r\n    if (!id) {\r\n      throw new Error('id is required');\r\n    }\r\n    return (await dbPromise).delete(STORIES_STORE, id);\r\n  },\r\n\r\n  // === Search & Filter Operations ===\r\n  \r\n  async searchStories(query) {\r\n    const allStories = await this.getAllStories();\r\n    if (!query) return allStories;\r\n    \r\n    const lowerQuery = query.toLowerCase();\r\n    return allStories.filter(story => \r\n      story.name?.toLowerCase().includes(lowerQuery) ||\r\n      story.description?.toLowerCase().includes(lowerQuery)\r\n    );\r\n  },\r\n\r\n  async sortStories(sortBy = 'createdAt', order = 'desc') {\r\n    const stories = await this.getAllStories();\r\n    \r\n    return stories.sort((a, b) => {\r\n      let aVal = a[sortBy];\r\n      let bVal = b[sortBy];\r\n      \r\n      if (sortBy === 'createdAt') {\r\n        aVal = new Date(aVal).getTime();\r\n        bVal = new Date(bVal).getTime();\r\n      } else if (typeof aVal === 'string') {\r\n        aVal = aVal.toLowerCase();\r\n        bVal = bVal.toLowerCase();\r\n      }\r\n      \r\n      if (order === 'asc') {\r\n        return aVal > bVal ? 1 : -1;\r\n      } else {\r\n        return aVal < bVal ? 1 : -1;\r\n      }\r\n    });\r\n  },\r\n\r\n  async filterStoriesByDate(startDate, endDate) {\r\n    const allStories = await this.getAllStories();\r\n    const start = new Date(startDate).getTime();\r\n    const end = new Date(endDate).getTime();\r\n    \r\n    return allStories.filter(story => {\r\n      const storyDate = new Date(story.createdAt).getTime();\r\n      return storyDate >= start && storyDate <= end;\r\n    });\r\n  },\r\n\r\n  // === Offline Sync Operations ===\r\n  \r\n  async savePendingStory(storyData) {\r\n    const pendingStory = {\r\n      ...storyData,\r\n      timestamp: Date.now(),\r\n      synced: false\r\n    };\r\n    const db = await dbPromise;\r\n    return await db.add(PENDING_STORE, pendingStory);\r\n  },\r\n\r\n  async getAllPendingStories() {\r\n    return (await dbPromise).getAll(PENDING_STORE);\r\n  },\r\n\r\n  async deletePendingStory(tempId) {\r\n    return (await dbPromise).delete(PENDING_STORE, tempId);\r\n  },\r\n\r\n  async clearAllPendingStories() {\r\n    const db = await dbPromise;\r\n    const tx = db.transaction(PENDING_STORE, 'readwrite');\r\n    await tx.objectStore(PENDING_STORE).clear();\r\n    await tx.done;\r\n  },\r\n\r\n  // === Statistics ===\r\n  \r\n  async getStoriesCount() {\r\n    const db = await dbPromise;\r\n    return await db.count(STORIES_STORE);\r\n  },\r\n\r\n  async getPendingCount() {\r\n    const db = await dbPromise;\r\n    return await db.count(PENDING_STORE);\r\n  }\r\n};\r\n\r\nexport default Database;\r\nexport const saveStory = Database.saveStory.bind(Database);","import { getStories } from '../../data/api';\nimport { initMap, filterMarkers } from '../../utils/index';\nimport Database from '../../utils/idb';\n\nexport default class HomePage {\n  async render() {\n    return `\n      <section class=\"container\">\n        <h1>Story Map</h1>\n        <h2>Explore Stories</h2>\n        <input type=\"text\" id=\"search\" placeholder=\"Search stories...\" aria-label=\"Search stories\">\n        <div id=\"map\" style=\"height: 400px;\" role=\"img\" aria-label=\"Interactive map of stories\"></div>\n        <h3>Story List</h3>\n        <ul id=\"story-list\" aria-label=\"List of stories\"></ul>\n      </section>\n    `;\n  }\n\n  async afterRender() {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('Please login first!');\n      location.hash = '#/auth';\n      return;\n    }\n\n    try {\n      const stories = await getStories();\n      const storyList = document.getElementById('story-list');\n      \n      if (stories.length === 0) {\n        storyList.innerHTML = '<li>No stories available.</li>';\n        return;\n      }\n\n      // Get saved story IDs for marking favorites\n      const savedStories = await Database.getAllStories();\n      const savedIds = new Set(savedStories.map(s => s.id));\n\n      storyList.innerHTML = stories.map(story => `\n        <li>\n          <img \n            src=\"${story.photoUrl || 'https://via.placeholder.com/300x200?text=No+Image'}\" \n            alt=\"${story.name} story image\" \n            onerror=\"this.src='https://via.placeholder.com/300x200?text=Image+Error'\"\n            loading=\"lazy\"\n          >\n          <h4>${story.name}</h4>\n          <p>${story.description}</p>\n          <small>${new Date(story.createdAt).toLocaleDateString('id-ID', {\n            year: 'numeric',\n            month: 'long',\n            day: 'numeric'\n          })}</small>\n          <button \n            class=\"favorite-btn ${savedIds.has(story.id) ? 'active' : ''}\" \n            data-id=\"${story.id}\"\n            aria-label=\"${savedIds.has(story.id) ? 'Remove from favorites' : 'Add to favorites'}\"\n          >\n            ${savedIds.has(story.id) ? '‚ù§Ô∏è Saved' : 'ü§ç Save'}\n          </button>\n        </li>\n      `).join('');\n\n      // Initialize map\n      initMap('map', stories);\n\n      // Setup search\n      document.getElementById('search').addEventListener('input', (e) => {\n        filterMarkers(e.target.value);\n      });\n\n      // Setup favorite buttons\n      document.querySelectorAll('.favorite-btn').forEach(btn => {\n        btn.addEventListener('click', async (e) => {\n          const button = e.target;\n          const id = button.dataset.id;\n          const story = stories.find(s => s.id === id);\n          \n          if (!story) return;\n\n          try {\n            const isActive = button.classList.contains('active');\n            \n            if (isActive) {\n              // Remove from favorites\n              await Database.deleteStory(id);\n              button.classList.remove('active');\n              button.textContent = 'ü§ç Save';\n              button.setAttribute('aria-label', 'Add to favorites');\n              this.#showToast('‚ùå Removed from favorites', 'error');\n            } else {\n              // Add to favorites\n              await Database.saveStory(story);\n              button.classList.add('active');\n              button.textContent = '‚ù§Ô∏è Saved';\n              button.setAttribute('aria-label', 'Remove from favorites');\n              this.#showToast('‚úÖ Saved to favorites!', 'success');\n            }\n          } catch (error) {\n            console.error('Error toggling favorite:', error);\n            this.#showToast('‚ö†Ô∏è Error: ' + error.message, 'error');\n          }\n        });\n      });\n\n    } catch (error) {\n      console.error('Error loading stories:', error);\n      alert('Error loading stories: ' + error.message);\n    }\n  }\n\n  #showToast(message, type = 'info') {\n    const toast = document.createElement('div');\n    toast.textContent = message;\n    toast.style.cssText = `\n      position: fixed;\n      bottom: 20px;\n      right: 20px;\n      background: ${type === 'success' ? 'linear-gradient(135deg, #27ae60, #2ecc71)' : 'linear-gradient(135deg, #e74c3c, #c0392b)'};\n      color: white;\n      padding: 15px 25px;\n      border-radius: 10px;\n      box-shadow: 0 4px 15px rgba(0,0,0,0.3);\n      z-index: 10000;\n      animation: slideIn 0.3s ease;\n      font-weight: 500;\n    `;\n    document.body.appendChild(toast);\n    \n    setTimeout(() => {\n      toast.style.animation = 'slideOut 0.3s ease';\n      setTimeout(() => toast.remove(), 300);\n    }, 3000);\n  }\n}","import Database from './idb';\r\nimport { addStory } from '../data/api';\r\n\r\nclass SyncHelper {\r\n  #isSyncing = false;\r\n  #syncListeners = [];\r\n\r\n  constructor() {\r\n    this.#setupEventListeners();\r\n  }\r\n\r\n  #setupEventListeners() {\r\n    // Listen for online/offline events\r\n    window.addEventListener('online', () => {\r\n      console.log('üåê Back online - triggering sync');\r\n      this.#showOnlineNotification();\r\n      this.syncPendingStories();\r\n    });\r\n\r\n    window.addEventListener('offline', () => {\r\n      console.log('üì° Offline mode activated');\r\n      this.#showOfflineNotification();\r\n    });\r\n\r\n    // Check initial state\r\n    if (!navigator.onLine) {\r\n      this.#showOfflineNotification();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Save story for later sync when offline\r\n   */\r\n  async saveForLaterSync(storyData) {\r\n    try {\r\n      const tempId = await Database.savePendingStory(storyData);\r\n      console.log('üì¶ Story saved for later sync:', tempId);\r\n      \r\n      this.#notifyListeners({\r\n        type: 'pending-added',\r\n        data: { tempId, storyData }\r\n      });\r\n      \r\n      return { success: true, tempId, offline: true };\r\n    } catch (error) {\r\n      console.error('Error saving for sync:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Sync all pending stories to server\r\n   */\r\n  async syncPendingStories() {\r\n    if (this.#isSyncing) {\r\n      console.log('‚è≥ Sync already in progress');\r\n      return { success: false, message: 'Sync already in progress' };\r\n    }\r\n\r\n    if (!navigator.onLine) {\r\n      console.log('üì° Cannot sync - offline');\r\n      return { success: false, message: 'Device is offline' };\r\n    }\r\n\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      console.log('üîí Cannot sync - not logged in');\r\n      return { success: false, message: 'User not logged in' };\r\n    }\r\n\r\n    this.#isSyncing = true;\r\n    this.#notifyListeners({ type: 'sync-started' });\r\n\r\n    try {\r\n      const pendingStories = await Database.getAllPendingStories();\r\n      \r\n      if (pendingStories.length === 0) {\r\n        console.log('‚úÖ No stories to sync');\r\n        this.#isSyncing = false;\r\n        return { success: true, synced: 0, message: 'No stories to sync' };\r\n      }\r\n\r\n      console.log(`üîÑ Syncing ${pendingStories.length} pending stories...`);\r\n      \r\n      const results = {\r\n        total: pendingStories.length,\r\n        success: 0,\r\n        failed: 0,\r\n        errors: []\r\n      };\r\n\r\n      for (const pendingStory of pendingStories) {\r\n        try {\r\n          // Convert base64 photo to file if needed\r\n          const photoFile = this.#base64ToFile(\r\n            pendingStory.photo,\r\n            'story-photo.jpg'\r\n          );\r\n\r\n          // Upload to API\r\n          await addStory({\r\n            name: pendingStory.name,\r\n            description: pendingStory.description,\r\n            photo: photoFile,\r\n            lat: pendingStory.lat,\r\n            lon: pendingStory.lon\r\n          });\r\n\r\n          // Remove from pending after successful upload\r\n          await Database.deletePendingStory(pendingStory.tempId);\r\n          \r\n          results.success++;\r\n          console.log(`‚úÖ Synced story ${results.success}/${results.total}`);\r\n          \r\n          this.#notifyListeners({\r\n            type: 'story-synced',\r\n            data: { \r\n              tempId: pendingStory.tempId,\r\n              progress: { current: results.success, total: results.total }\r\n            }\r\n          });\r\n\r\n        } catch (error) {\r\n          results.failed++;\r\n          results.errors.push({\r\n            tempId: pendingStory.tempId,\r\n            error: error.message\r\n          });\r\n          console.error(`‚ùå Failed to sync story:`, error);\r\n        }\r\n      }\r\n\r\n      this.#isSyncing = false;\r\n      \r\n      const finalResult = {\r\n        success: results.failed === 0,\r\n        synced: results.success,\r\n        failed: results.failed,\r\n        total: results.total,\r\n        message: `Synced ${results.success}/${results.total} stories`\r\n      };\r\n\r\n      this.#notifyListeners({\r\n        type: 'sync-completed',\r\n        data: finalResult\r\n      });\r\n\r\n      if (results.success > 0) {\r\n        this.#showSyncNotification(finalResult);\r\n      }\r\n\r\n      return finalResult;\r\n\r\n    } catch (error) {\r\n      this.#isSyncing = false;\r\n      console.error('‚ùå Sync failed:', error);\r\n      \r\n      this.#notifyListeners({\r\n        type: 'sync-failed',\r\n        data: { error: error.message }\r\n      });\r\n      \r\n      return { \r\n        success: false, \r\n        message: 'Sync failed: ' + error.message \r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get pending stories count\r\n   */\r\n  async getPendingCount() {\r\n    return await Database.getPendingCount();\r\n  }\r\n\r\n  /**\r\n   * Get all pending stories\r\n   */\r\n  async getPendingStories() {\r\n    return await Database.getAllPendingStories();\r\n  }\r\n\r\n  /**\r\n   * Clear all pending stories\r\n   */\r\n  async clearPendingStories() {\r\n    await Database.clearAllPendingStories();\r\n    this.#notifyListeners({ type: 'pending-cleared' });\r\n  }\r\n\r\n  /**\r\n   * Check if currently syncing\r\n   */\r\n  isSyncing() {\r\n    return this.#isSyncing;\r\n  }\r\n\r\n  /**\r\n   * Check if device is online\r\n   */\r\n  isOnline() {\r\n    return navigator.onLine;\r\n  }\r\n\r\n  /**\r\n   * Register sync listener\r\n   */\r\n  onSyncEvent(callback) {\r\n    this.#syncListeners.push(callback);\r\n    return () => {\r\n      this.#syncListeners = this.#syncListeners.filter(cb => cb !== callback);\r\n    };\r\n  }\r\n\r\n  #notifyListeners(event) {\r\n    this.#syncListeners.forEach(callback => {\r\n      try {\r\n        callback(event);\r\n      } catch (error) {\r\n        console.error('Sync listener error:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  #base64ToFile(base64String, filename) {\r\n    // If already a File object, return it\r\n    if (base64String instanceof File) {\r\n      return base64String;\r\n    }\r\n\r\n    // If base64 string, convert to File\r\n    const arr = base64String.split(',');\r\n    const mime = arr[0].match(/:(.*?);/)[1];\r\n    const bstr = atob(arr[1]);\r\n    let n = bstr.length;\r\n    const u8arr = new Uint8Array(n);\r\n    \r\n    while (n--) {\r\n      u8arr[n] = bstr.charCodeAt(n);\r\n    }\r\n    \r\n    return new File([u8arr], filename, { type: mime });\r\n  }\r\n\r\n  #showOnlineNotification() {\r\n    const notification = document.createElement('div');\r\n    notification.style.cssText = `\r\n      position: fixed;\r\n      top: 20px;\r\n      right: 20px;\r\n      background: linear-gradient(135deg, #27ae60, #2ecc71);\r\n      color: white;\r\n      padding: 15px 25px;\r\n      border-radius: 10px;\r\n      box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);\r\n      z-index: 10000;\r\n      font-weight: bold;\r\n      animation: slideIn 0.3s ease;\r\n    `;\r\n    notification.innerHTML = 'üåê Back online!';\r\n    document.body.appendChild(notification);\r\n    \r\n    setTimeout(() => {\r\n      notification.style.animation = 'slideOut 0.3s ease';\r\n      setTimeout(() => notification.remove(), 300);\r\n    }, 3000);\r\n  }\r\n\r\n  #showOfflineNotification() {\r\n    const existingIndicator = document.getElementById('offline-indicator');\r\n    if (existingIndicator) return;\r\n\r\n    const indicator = document.createElement('div');\r\n    indicator.id = 'offline-indicator';\r\n    indicator.style.cssText = `\r\n      position: fixed;\r\n      top: 0;\r\n      left: 0;\r\n      right: 0;\r\n      background: linear-gradient(135deg, #e74c3c, #c0392b);\r\n      color: white;\r\n      padding: 12px;\r\n      text-align: center;\r\n      z-index: 10000;\r\n      font-weight: bold;\r\n      box-shadow: 0 2px 10px rgba(0,0,0,0.2);\r\n    `;\r\n    indicator.innerHTML = 'üì° You are offline - Changes will sync when connection returns';\r\n    document.body.appendChild(indicator);\r\n\r\n    // Remove when online\r\n    const removeIndicator = () => {\r\n      indicator.remove();\r\n      window.removeEventListener('online', removeIndicator);\r\n    };\r\n    window.addEventListener('online', removeIndicator);\r\n  }\r\n\r\n  async #showSyncNotification(result) {\r\n    const notification = document.createElement('div');\r\n    notification.style.cssText = `\r\n      position: fixed;\r\n      bottom: 20px;\r\n      right: 20px;\r\n      background: linear-gradient(135deg, #3498db, #2980b9);\r\n      color: white;\r\n      padding: 20px 30px;\r\n      border-radius: 10px;\r\n      box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);\r\n      z-index: 10000;\r\n      max-width: 300px;\r\n    `;\r\n    notification.innerHTML = `\r\n      <strong>‚úÖ Sync Complete</strong><br>\r\n      <span style=\"font-size: 0.9rem;\">\r\n        ${result.synced} of ${result.total} stories synced\r\n        ${result.failed > 0 ? `<br>${result.failed} failed` : ''}\r\n      </span>\r\n    `;\r\n    document.body.appendChild(notification);\r\n    \r\n    setTimeout(() => {\r\n      notification.style.animation = 'slideOut 0.3s ease';\r\n      setTimeout(() => notification.remove(), 300);\r\n    }, 5000);\r\n  }\r\n}\r\n\r\n// Create singleton instance\r\nconst syncHelper = new SyncHelper();\r\n\r\nexport default syncHelper;","import { addStory } from '../../data/api';\nimport { validateForm } from '../../utils/index';\nimport syncHelper from '../../utils/sync-helper';\n\nexport default class AddPage {\n  async render() {\n    return `\n      <section class=\"container\">\n        <h1>Add New Story</h1>\n        <h2>Share Your Story</h2>\n        <form id=\"add-form\">\n          <label for=\"name\">Title:</label>\n          <input type=\"text\" id=\"name\" required aria-describedby=\"name-error\">\n          <span id=\"name-error\" class=\"error\" role=\"alert\"></span>\n\n          <label for=\"description\">Description:</label>\n          <textarea id=\"description\" required aria-describedby=\"desc-error\"></textarea>\n          <span id=\"desc-error\" class=\"error\" role=\"alert\"></span>\n\n          <label for=\"photo\">Photo:</label>\n          <input type=\"file\" id=\"photo\" accept=\"image/*\" required aria-describedby=\"photo-error\">\n          <button type=\"button\" id=\"camera-btn\">Use Camera</button>\n          <span id=\"photo-error\" class=\"error\" role=\"alert\"></span>\n\n          <h3>Select Location</h3>\n          <p>Drag the marker to set location:</p>\n          <div id=\"map\" style=\"height: 200px;\" role=\"img\" aria-label=\"Map to select location\"></div>\n\n          <label for=\"latitude\">Latitude:</label>\n          <input type=\"number\" id=\"latitude\" disabled value=\"-6.175389\">\n\n          <label for=\"longitude\">Longitude:</label>\n          <input type=\"number\" id=\"longitude\" disabled value=\"106.827139\">\n\n          <button type=\"submit\">Submit</button>\n        </form>\n      </section>\n    `;\n  }\n\n  async afterRender() {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('Please login to add story!');\n      location.hash = '#/auth';\n      return;\n    }\n\n    // === Map setup ===\n    let lat = -6.175389, lon = 106.827139;\n    const map = L.map('map').setView([lat, lon], 15);\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);\n    const marker = L.marker([lat, lon], { draggable: true }).addTo(map);\n\n    marker.on('dragend', (event) => {\n      const { lat: newLat, lng: newLon } = event.target.getLatLng();\n      lat = newLat;\n      lon = newLon;\n      document.getElementById('latitude').value = lat;\n      document.getElementById('longitude').value = lon;\n    });\n\n    map.on('click', (event) => {\n      marker.setLatLng(event.latlng);\n      lat = event.latlng.lat;\n      lon = event.latlng.lng;\n      document.getElementById('latitude').value = lat;\n      document.getElementById('longitude').value = lon;\n      map.flyTo(event.latlng);\n    });\n\n    // === Submit form ===\n    const form = document.getElementById('add-form');\n    form.addEventListener('submit', async (e) => {\n      e.preventDefault();\n      const name = document.getElementById('name').value.trim();\n      const description = document.getElementById('description').value.trim();\n      const photo = document.getElementById('photo').files[0];\n\n      if (!validateForm({ name, description, photo })) return;\n\n      const submitButton = form.querySelector('button[type=\"submit\"]');\n      submitButton.disabled = true;\n      submitButton.textContent = 'Uploading...';\n\n      try {\n        if (!navigator.onLine) {\n          // === OFFLINE MODE ===\n          const reader = new FileReader();\n          reader.readAsDataURL(photo);\n          reader.onload = async () => {\n            await syncHelper.saveForLaterSync({\n              name,\n              description,\n              photo: reader.result,\n              lat,\n              lon\n            });\n            alert('Offline mode: Story will be uploaded when connection returns');\n            location.hash = '#/home';\n          };\n        } else {\n          // === ONLINE MODE ===\n          await addStory({ name, description, photo, lat, lon });\n          \n          // === TRIGGER PUSH NOTIFICATION ===\n          await this.#sendPushNotification(name);\n          \n          alert('Story added successfully!');\n          location.hash = '#/home';\n        }\n      } catch (error) {\n        console.error('Error adding story:', error);\n        alert('Error: ' + error.message);\n        submitButton.disabled = false;\n        submitButton.textContent = 'Submit';\n      }\n    });\n\n    // === Camera Feature ===\n    document.getElementById('camera-btn').addEventListener('click', async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n        const modal = document.createElement('div');\n        modal.style.cssText = `\n          position: fixed;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          background: rgba(0,0,0,0.9);\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          z-index: 10000;\n          gap: 20px;\n        `;\n\n        const video = document.createElement('video');\n        video.srcObject = stream;\n        video.autoplay = true;\n        video.style.cssText = `\n          width: 90%;\n          max-width: 400px;\n          border-radius: 10px;\n          box-shadow: 0 4px 20px rgba(0,0,0,0.5);\n        `;\n\n        const buttonContainer = document.createElement('div');\n        buttonContainer.style.cssText = `\n          display: flex;\n          gap: 15px;\n        `;\n\n        const captureBtn = document.createElement('button');\n        captureBtn.textContent = 'üì∏ Capture';\n        captureBtn.style.cssText = `\n          padding: 15px 30px;\n          font-size: 1rem;\n          background: linear-gradient(135deg, #27ae60, #2ecc71);\n          color: white;\n          border: none;\n          border-radius: 10px;\n          cursor: pointer;\n          font-weight: bold;\n        `;\n\n        const cancelBtn = document.createElement('button');\n        cancelBtn.textContent = '‚ùå Cancel';\n        cancelBtn.style.cssText = `\n          padding: 15px 30px;\n          font-size: 1rem;\n          background: linear-gradient(135deg, #e74c3c, #c0392b);\n          color: white;\n          border: none;\n          border-radius: 10px;\n          cursor: pointer;\n          font-weight: bold;\n        `;\n\n        buttonContainer.appendChild(captureBtn);\n        buttonContainer.appendChild(cancelBtn);\n        modal.appendChild(video);\n        modal.appendChild(buttonContainer);\n        document.body.appendChild(modal);\n\n        captureBtn.addEventListener('click', () => {\n          const canvas = document.createElement('canvas');\n          canvas.width = video.videoWidth;\n          canvas.height = video.videoHeight;\n          canvas.getContext('2d').drawImage(video, 0, 0);\n          canvas.toBlob((blob) => {\n            const file = new File([blob], 'capture.jpg', { type: 'image/jpeg' });\n            const dt = new DataTransfer();\n            dt.items.add(file);\n            document.getElementById('photo').files = dt.files;\n            alert('üì∏ Image captured successfully!');\n          });\n          stream.getTracks().forEach(track => track.stop());\n          document.body.removeChild(modal);\n        });\n\n        cancelBtn.addEventListener('click', () => {\n          stream.getTracks().forEach(track => track.stop());\n          document.body.removeChild(modal);\n        });\n      } catch (err) {\n        console.error('Camera error:', err);\n        alert('Camera access denied or not available: ' + err.message);\n      }\n    });\n  }\n\n  async #sendPushNotification(storyName) {\n    try {\n      // Check if service worker is ready\n      if (!('serviceWorker' in navigator)) {\n        console.log('Service Worker not supported');\n        return;\n      }\n\n      const registration = await navigator.serviceWorker.ready;\n      \n      // Check if user has notification permission\n      if (Notification.permission !== 'granted') {\n        console.log('Notification permission not granted');\n        return;\n      }\n\n      // Show notification directly from service worker\n      await registration.showNotification('üéâ Story Added!', {\n        body: `Your story \"${storyName}\" has been published successfully!`,\n        icon: '/favicon.png',\n        badge: '/favicon.png',\n        vibrate: [200, 100, 200],\n        tag: 'story-added',\n        requireInteraction: false,\n        actions: [\n          { action: 'view', title: 'üëÄ View Story', icon: '/favicon.png' },\n          { action: 'close', title: '‚úÖ OK', icon: '/favicon.png' }\n        ],\n        data: {\n          url: '/#/home',\n          timestamp: Date.now(),\n          type: 'story-added'\n        }\n      });\n\n      console.log('‚úÖ Push notification sent successfully');\n    } catch (error) {\n      console.error('‚ùå Error sending notification:', error);\n    }\n  }\n}","import { login, register } from \"../../data/api\";\n\nexport default class AuthPage {\n  async render() {\n    return `\n      <section class=\"container\">\n        <h1>Authentication</h1>\n        <div id=\"auth-container\">\n          <h2 id=\"form-title\">Login</h2>\n          <form id=\"auth-form\">\n            <label for=\"email\">Email:</label>\n            <input type=\"email\" id=\"email\" required>\n            <label for=\"password\">Password:</label>\n            <input type=\"password\" id=\"password\" required>\n            <button type=\"submit\" id=\"submit-btn\">Login</button>\n          </form>\n          <p>Belum punya akun? <a href=\"#\" id=\"toggle-link\">Register</a></p>\n        </div>\n      </section>\n    `;\n  }\n\n  async afterRender() {\n    let isLogin = true;\n    const formTitle = document.getElementById(\"form-title\");\n    const form = document.getElementById(\"auth-form\");\n    const toggleLink = document.getElementById(\"toggle-link\");\n\n    const updateForm = () => {\n      if (isLogin) {\n        formTitle.textContent = \"Login\";\n        form.innerHTML = `\n      <label for=\"email\">Email:</label>\n      <input type=\"email\" id=\"email\" required>\n      <label for=\"password\">Password:</label>\n      <input type=\"password\" id=\"password\" required>\n      <button type=\"submit\" id=\"submit-btn\">Login</button>\n    `;\n        toggleLink.textContent = \"Register\";\n        toggleLink.previousSibling.textContent = \"Belum punya akun? \";\n      } else {\n        formTitle.textContent = \"Register\";\n        form.innerHTML = `\n      <label for=\"reg-name\">Name:</label>\n      <input type=\"text\" id=\"reg-name\" required>\n      <label for=\"reg-email\">Email:</label>\n      <input type=\"email\" id=\"reg-email\" required>\n      <label for=\"reg-password\">Password:</label>\n      <input type=\"password\" id=\"reg-password\" required>\n      <button type=\"submit\" id=\"submit-btn\">Register</button>\n    `;\n        toggleLink.textContent = \"Login\";\n        toggleLink.previousSibling.textContent = \"Sudah punya akun? \";\n      }\n      const submitBtn = document.getElementById(\"submit-btn\");\n      submitBtn.addEventListener(\"click\", handleSubmit);\n    };\n\n    const handleSubmit = async (e) => {\n      e.preventDefault();\n      if (isLogin) {\n        const email = document.getElementById(\"email\").value;\n        const password = document.getElementById(\"password\").value;\n        try {\n          await login({ email, password });\n          alert(\"Login successful!\");\n          location.hash = \"#/home\";\n        } catch (error) {\n          alert(\"Login failed: \" + error.message);\n        }\n      } else {\n        const name = document.getElementById(\"reg-name\").value;\n        const email = document.getElementById(\"reg-email\").value;\n        const password = document.getElementById(\"reg-password\").value;\n        try {\n          await register({ name, email, password });\n          alert(\"Register successful! Now login.\");\n          isLogin = true;\n          updateForm();\n        } catch (error) {\n          alert(\"Register failed: \" + error.message);\n        }\n      }\n    };\n\n    toggleLink.addEventListener(\"click\", (e) => {\n      e.preventDefault();\n      isLogin = !isLogin;\n      updateForm();\n    });\n\n    updateForm();\n  }\n}\n","import Database from '../../utils/idb';\r\nimport { initMap, addMarkers } from '../../utils/index';\r\n\r\nexport default class FavoritePage {\r\n  #allStories = [];\r\n  #filteredStories = [];\r\n  #currentSort = 'createdAt';\r\n  #currentOrder = 'desc';\r\n\r\n  async render() {\r\n    return `\r\n      <section class=\"container\">\r\n        <h1>Favorite Stories</h1>\r\n        <p>Your saved stories for offline access</p>\r\n        \r\n        <!-- Filter & Sort Controls -->\r\n        <div class=\"filter-controls\" style=\"margin: 20px 0; display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;\">\r\n          <input \r\n            type=\"text\" \r\n            id=\"search-favorites\" \r\n            placeholder=\"Search favorites...\" \r\n            style=\"flex: 1; min-width: 200px; max-width: 400px;\"\r\n            aria-label=\"Search favorite stories\"\r\n          >\r\n          \r\n          <select id=\"sort-by\" style=\"padding: 12px; border-radius: 8px;\" aria-label=\"Sort by\">\r\n            <option value=\"createdAt\">Sort by Date</option>\r\n            <option value=\"name\">Sort by Name</option>\r\n          </select>\r\n          \r\n          <select id=\"sort-order\" style=\"padding: 12px; border-radius: 8px;\" aria-label=\"Sort order\">\r\n            <option value=\"desc\">Newest First</option>\r\n            <option value=\"asc\">Oldest First</option>\r\n          </select>\r\n          \r\n          <button id=\"clear-all\" style=\"background: #e74c3c; padding: 12px 20px;\" aria-label=\"Clear all favorites\">\r\n            Clear All\r\n          </button>\r\n        </div>\r\n\r\n        <!-- Stats -->\r\n        <div id=\"favorite-stats\" style=\"text-align: center; margin: 20px 0; color: #555;\">\r\n          Loading...\r\n        </div>\r\n\r\n        <!-- Map View -->\r\n        <div id=\"map\" style=\"height: 300px; margin: 20px 0; border-radius: 10px;\"></div>\r\n\r\n        <!-- Stories List -->\r\n        <div id=\"favorite-list-container\">\r\n          <div id=\"loading-indicator\" style=\"text-align: center; padding: 40px;\">\r\n            <p>Loading your favorites...</p>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    `;\r\n  }\r\n\r\n  async afterRender() {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      alert('Please login to view favorites!');\r\n      location.hash = '#/auth';\r\n      return;\r\n    }\r\n\r\n    await this.#loadStories();\r\n    this.#setupEventListeners();\r\n    this.#renderStats();\r\n  }\r\n\r\n  async #loadStories() {\r\n    try {\r\n      this.#allStories = await Database.getAllStories();\r\n      this.#filteredStories = [...this.#allStories];\r\n      await this.#renderStories();\r\n      this.#initializeMap();\r\n    } catch (error) {\r\n      console.error('Error loading stories:', error);\r\n      this.#showError('Failed to load favorites');\r\n    }\r\n  }\r\n\r\n  #initializeMap() {\r\n    if (this.#filteredStories.length > 0) {\r\n      try {\r\n        initMap('map', this.#filteredStories);\r\n      } catch (error) {\r\n        console.error('Error initializing map:', error);\r\n      }\r\n    }\r\n  }\r\n\r\n  async #renderStories() {\r\n    const container = document.getElementById('favorite-list-container');\r\n    \r\n    if (this.#filteredStories.length === 0) {\r\n      container.innerHTML = `\r\n        <div style=\"text-align: center; padding: 40px;\">\r\n          <p style=\"font-size: 1.2rem; color: #666;\">\r\n            ${this.#allStories.length === 0 \r\n              ? 'No favorite stories yet. Go to Home to save some!' \r\n              : 'No stories match your search.'}\r\n          </p>\r\n        </div>\r\n      `;\r\n      return;\r\n    }\r\n\r\n    const storiesHTML = this.#filteredStories.map(story => `\r\n      <li data-story-id=\"${story.id}\">\r\n        <img \r\n          src=\"${story.photoUrl || 'https://via.placeholder.com/300x200?text=No+Image'}\" \r\n          alt=\"${story.name} story image\" \r\n          onerror=\"this.src='https://via.placeholder.com/300x200?text=Image+Error'\"\r\n          loading=\"lazy\"\r\n        >\r\n        <h4>${story.name || 'Untitled Story'}</h4>\r\n        <p>${story.description || 'No description'}</p>\r\n        <small>${new Date(story.createdAt).toLocaleDateString('id-ID', {\r\n          year: 'numeric',\r\n          month: 'long',\r\n          day: 'numeric',\r\n          hour: '2-digit',\r\n          minute: '2-digit'\r\n        })}</small>\r\n        <div style=\"margin-top: 10px; display: flex; gap: 10px;\">\r\n          <button \r\n            class=\"delete-btn\" \r\n            data-id=\"${story.id}\"\r\n            style=\"flex: 1; background: #e74c3c;\"\r\n            aria-label=\"Delete ${story.name}\"\r\n          >\r\n            Delete\r\n          </button>\r\n          <button \r\n            class=\"view-location-btn\" \r\n            data-lat=\"${story.lat}\" \r\n            data-lon=\"${story.lon}\"\r\n            style=\"flex: 1; background: #3498db;\"\r\n            aria-label=\"View ${story.name} on map\"\r\n          >\r\n            View on Map\r\n          </button>\r\n        </div>\r\n      </li>\r\n    `).join('');\r\n\r\n    container.innerHTML = `\r\n      <ul id=\"favorite-list\" style=\"list-style: none; display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; margin-top: 20px;\">\r\n        ${storiesHTML}\r\n      </ul>\r\n    `;\r\n\r\n    this.#attachStoryEventListeners();\r\n  }\r\n\r\n  #attachStoryEventListeners() {\r\n    // Delete buttons\r\n    document.querySelectorAll('.delete-btn').forEach(btn => {\r\n      btn.addEventListener('click', async (e) => {\r\n        const id = e.target.dataset.id;\r\n        const story = this.#allStories.find(s => s.id === id);\r\n        \r\n        if (confirm(`Delete \"${story?.name || 'this story'}\" from favorites?`)) {\r\n          await this.#deleteStory(id);\r\n        }\r\n      });\r\n    });\r\n\r\n    // View location buttons\r\n    document.querySelectorAll('.view-location-btn').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        const lat = parseFloat(e.target.dataset.lat);\r\n        const lon = parseFloat(e.target.dataset.lon);\r\n        \r\n        // Scroll to map and focus on location\r\n        const mapElement = document.getElementById('map');\r\n        mapElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n        \r\n        // You can add more map interaction here if needed\r\n        console.log('Viewing location:', { lat, lon });\r\n      });\r\n    });\r\n  }\r\n\r\n  async #deleteStory(id) {\r\n    try {\r\n      await Database.deleteStory(id);\r\n      \r\n      // Update local arrays\r\n      this.#allStories = this.#allStories.filter(s => s.id !== id);\r\n      this.#filteredStories = this.#filteredStories.filter(s => s.id !== id);\r\n      \r\n      // Re-render\r\n      await this.#renderStories();\r\n      this.#renderStats();\r\n      this.#initializeMap();\r\n      \r\n      this.#showSuccess('Story removed from favorites');\r\n    } catch (error) {\r\n      console.error('Error deleting story:', error);\r\n      this.#showError('Failed to delete story');\r\n    }\r\n  }\r\n\r\n  #setupEventListeners() {\r\n    // Search\r\n    const searchInput = document.getElementById('search-favorites');\r\n    searchInput.addEventListener('input', async (e) => {\r\n      const query = e.target.value.trim();\r\n      await this.#applyFilters(query);\r\n    });\r\n\r\n    // Sort by\r\n    const sortBySelect = document.getElementById('sort-by');\r\n    sortBySelect.addEventListener('change', async (e) => {\r\n      this.#currentSort = e.target.value;\r\n      \r\n      // Update order options based on sort type\r\n      const orderSelect = document.getElementById('sort-order');\r\n      if (this.#currentSort === 'name') {\r\n        orderSelect.innerHTML = `\r\n          <option value=\"asc\">A to Z</option>\r\n          <option value=\"desc\">Z to A</option>\r\n        `;\r\n      } else {\r\n        orderSelect.innerHTML = `\r\n          <option value=\"desc\">Newest First</option>\r\n          <option value=\"asc\">Oldest First</option>\r\n        `;\r\n      }\r\n      orderSelect.value = this.#currentOrder;\r\n      \r\n      await this.#applySort();\r\n    });\r\n\r\n    // Sort order\r\n    const sortOrderSelect = document.getElementById('sort-order');\r\n    sortOrderSelect.addEventListener('change', async (e) => {\r\n      this.#currentOrder = e.target.value;\r\n      await this.#applySort();\r\n    });\r\n\r\n    // Clear all\r\n    const clearAllBtn = document.getElementById('clear-all');\r\n    clearAllBtn.addEventListener('click', async () => {\r\n      if (this.#allStories.length === 0) {\r\n        alert('No favorites to clear');\r\n        return;\r\n      }\r\n      \r\n      if (confirm(`Clear all ${this.#allStories.length} favorite stories?`)) {\r\n        await this.#clearAllFavorites();\r\n      }\r\n    });\r\n  }\r\n\r\n  async #applyFilters(query = '') {\r\n    try {\r\n      if (!query) {\r\n        this.#filteredStories = [...this.#allStories];\r\n      } else {\r\n        this.#filteredStories = await Database.searchStories(query);\r\n      }\r\n      \r\n      await this.#applySort();\r\n    } catch (error) {\r\n      console.error('Error applying filters:', error);\r\n    }\r\n  }\r\n\r\n  async #applySort() {\r\n    try {\r\n      // Sort the filtered stories\r\n      this.#filteredStories = this.#filteredStories.sort((a, b) => {\r\n        let aVal = a[this.#currentSort];\r\n        let bVal = b[this.#currentSort];\r\n        \r\n        if (this.#currentSort === 'createdAt') {\r\n          aVal = new Date(aVal).getTime();\r\n          bVal = new Date(bVal).getTime();\r\n        } else if (typeof aVal === 'string') {\r\n          aVal = aVal.toLowerCase();\r\n          bVal = bVal.toLowerCase();\r\n        }\r\n        \r\n        if (this.#currentOrder === 'asc') {\r\n          return aVal > bVal ? 1 : -1;\r\n        } else {\r\n          return aVal < bVal ? 1 : -1;\r\n        }\r\n      });\r\n      \r\n      await this.#renderStories();\r\n      this.#initializeMap();\r\n    } catch (error) {\r\n      console.error('Error sorting:', error);\r\n    }\r\n  }\r\n\r\n  async #clearAllFavorites() {\r\n    try {\r\n      // Delete all stories one by one\r\n      for (const story of this.#allStories) {\r\n        await Database.deleteStory(story.id);\r\n      }\r\n      \r\n      this.#allStories = [];\r\n      this.#filteredStories = [];\r\n      \r\n      await this.#renderStories();\r\n      this.#renderStats();\r\n      \r\n      this.#showSuccess('All favorites cleared');\r\n    } catch (error) {\r\n      console.error('Error clearing favorites:', error);\r\n      this.#showError('Failed to clear favorites');\r\n    }\r\n  }\r\n\r\n  async #renderStats() {\r\n    try {\r\n      const count = await Database.getStoriesCount();\r\n      const pendingCount = await Database.getPendingCount();\r\n      \r\n      const statsElement = document.getElementById('favorite-stats');\r\n      statsElement.innerHTML = `\r\n        <p style=\"font-size: 1.1rem;\">\r\n          üìö <strong>${count}</strong> favorite ${count === 1 ? 'story' : 'stories'}\r\n          ${pendingCount > 0 ? `| üì§ <strong>${pendingCount}</strong> pending sync` : ''}\r\n        </p>\r\n        ${this.#filteredStories.length !== count ? \r\n          `<p style=\"color: #3498db;\">Showing ${this.#filteredStories.length} of ${count}</p>` : \r\n          ''}\r\n      `;\r\n    } catch (error) {\r\n      console.error('Error rendering stats:', error);\r\n    }\r\n  }\r\n\r\n  #showSuccess(message) {\r\n    const toast = document.createElement('div');\r\n    toast.textContent = message;\r\n    toast.style.cssText = `\r\n      position: fixed;\r\n      bottom: 20px;\r\n      right: 20px;\r\n      background: #27ae60;\r\n      color: white;\r\n      padding: 15px 25px;\r\n      border-radius: 8px;\r\n      box-shadow: 0 4px 12px rgba(0,0,0,0.2);\r\n      z-index: 10000;\r\n      animation: slideIn 0.3s ease;\r\n    `;\r\n    document.body.appendChild(toast);\r\n    setTimeout(() => toast.remove(), 3000);\r\n  }\r\n\r\n  #showError(message) {\r\n    const toast = document.createElement('div');\r\n    toast.textContent = message;\r\n    toast.style.cssText = `\r\n      position: fixed;\r\n      bottom: 20px;\r\n      right: 20px;\r\n      background: #e74c3c;\r\n      color: white;\r\n      padding: 15px 25px;\r\n      border-radius: 8px;\r\n      box-shadow: 0 4px 12px rgba(0,0,0,0.2);\r\n      z-index: 10000;\r\n    `;\r\n    document.body.appendChild(toast);\r\n    setTimeout(() => toast.remove(), 3000);\r\n  }\r\n}","import HomePage from '../pages/home/home-page';\nimport AddPage from '../pages/add/add-page';\nimport AuthPage from '../pages/auth/auth-page';\nimport FavoritePage from '../pages/favorite/favorite-page';\n\nconst routes = {\n  '/home': new HomePage(),\n  '/add': new AddPage(),\n  '/auth': new AuthPage(),\n  '/favorite': new FavoritePage(),\n};\n\nexport default routes;","function extractPathnameSegments(path) {\n  const splitUrl = path.split(\"/\");\n\n  return {\n    resource: splitUrl[1] || null,\n    id: splitUrl[2] || null,\n  };\n}\n\nfunction constructRouteFromSegments(pathSegments) {\n  let pathname = \"\";\n\n  if (pathSegments.resource) {\n    pathname = pathname.concat(`/${pathSegments.resource}`);\n  }\n\n  if (pathSegments.id) {\n    pathname = pathname.concat(\"/:id\");\n  }\n\n  return pathname || \"/\";\n}\n\nexport function getActivePathname() {\n  return location.hash.replace(\"#\", \"\") || \"/\";\n}\n\nexport function getActiveRoute() {\n  const pathname = getActivePathname();\n  const urlSegments = extractPathnameSegments(pathname);\n  return constructRouteFromSegments(urlSegments);\n}\n\nexport function parseActivePathname() {\n  const pathname = getActivePathname();\n  return extractPathnameSegments(pathname);\n}\n\nexport function getRoute(pathname) {\n  const urlSegments = extractPathnameSegments(pathname);\n  return constructRouteFromSegments(urlSegments);\n}\n\nexport function parsePathname(pathname) {\n  return extractPathnameSegments(pathname);\n}\n","import { subscribePushNotification, unsubscribePushNotification } from '../data/api';\r\n\r\nfunction urlBase64ToUint8Array(base64String) {\r\n  const padding = '='.repeat((4 - base64String.length % 4) % 4);\r\n  const base64 = (base64String + padding)\r\n    .replace(/-/g, '+')\r\n    .replace(/_/g, '/');\r\n  const rawData = window.atob(base64);\r\n  const outputArray = new Uint8Array(rawData.length);\r\n  for (let i = 0; i < rawData.length; ++i) {\r\n    outputArray[i] = rawData.charCodeAt(i);\r\n  }\r\n  return outputArray;\r\n}\r\n\r\nconst VAPID_PUBLIC_KEY = 'BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk';\r\n\r\nexport function isNotificationAvailable() {\r\n  return 'Notification' in window;\r\n}\r\n\r\nexport function isNotificationGranted() {\r\n  return Notification.permission === 'granted';\r\n}\r\n\r\nexport async function requestNotificationPermission() {\r\n  if (!isNotificationAvailable()) {\r\n    console.error('Notification API unsupported.');\r\n    return false;\r\n  }\r\n\r\n  if (isNotificationGranted()) {\r\n    return true;\r\n  }\r\n\r\n  const status = await Notification.requestPermission();\r\n\r\n  if (status === 'denied') {\r\n    alert('Izin notifikasi ditolak.');\r\n    return false;\r\n  }\r\n\r\n  if (status === 'default') {\r\n    alert('Izin notifikasi ditutup atau diabaikan.');\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nexport async function getPushSubscription() {\r\n  const registration = await navigator.serviceWorker.getRegistration();\r\n  if (!registration) {\r\n    console.log('Service worker not registered yet');\r\n    return null;\r\n  }\r\n  return await registration.pushManager.getSubscription();\r\n}\r\n\r\nexport async function isCurrentPushSubscriptionAvailable() {\r\n  const sub = await getPushSubscription();\r\n  return !!sub;\r\n}\r\n\r\nexport async function subscribe() {\r\n  const registration = await navigator.serviceWorker.getRegistration();\r\n  if (!registration) {\r\n    alert('Service worker not ready, please reload the page');\r\n    return;\r\n  }\r\n\r\n  if (!(await requestNotificationPermission())) {\r\n    return;\r\n  }\r\n\r\n  if (await isCurrentPushSubscriptionAvailable()) {\r\n    alert('Sudah berlangganan push notification.');\r\n    return;\r\n  }\r\n\r\n  console.log('Mulai berlangganan push notification...');\r\n\r\n  const failureSubscribeMessage = 'Langganan push notification gagal diaktifkan.';\r\n  const successSubscribeMessage = 'Langganan push notification berhasil diaktifkan.';\r\n  let pushSubscription;\r\n  try {\r\n    const registration = await navigator.serviceWorker.getRegistration();\r\n    pushSubscription = await registration.pushManager.subscribe({\r\n      userVisibleOnly: true,\r\n      applicationServerKey: urlBase64ToUint8Array(VAPID_PUBLIC_KEY),\r\n    });\r\n\r\n    const { endpoint, keys } = pushSubscription.toJSON();\r\n    const response = await subscribePushNotification({ endpoint, keys });\r\n    if (!response.ok) {\r\n      console.error('subscribe: response:', response);\r\n      alert(failureSubscribeMessage);\r\n      await pushSubscription.unsubscribe();\r\n      return;\r\n    }\r\n\r\n    alert(successSubscribeMessage);\r\n  } catch (error) {\r\n    console.error('subscribe: error:', error);\r\n    alert(failureSubscribeMessage);\r\n    if (pushSubscription) {\r\n      await pushSubscription.unsubscribe();\r\n    }\r\n  }\r\n}\r\n\r\nexport async function unsubscribe() {\r\n  const failureUnsubscribeMessage = 'Langganan push notification gagal dinonaktifkan.';\r\n  const successUnsubscribeMessage = 'Langganan push notification berhasil dinonaktifkan.';\r\n  try {\r\n    const pushSubscription = await getPushSubscription();\r\n    if (!pushSubscription) {\r\n      alert('Tidak bisa memutus langganan push notification karena belum berlangganan sebelumnya.');\r\n      return;\r\n    }\r\n    const { endpoint } = pushSubscription.toJSON();\r\n    const response = await unsubscribePushNotification({ endpoint });\r\n    if (!response.ok) {\r\n      alert(failureUnsubscribeMessage);\r\n      console.error('unsubscribe: response:', response);\r\n      return;\r\n    }\r\n    const unsubscribed = await pushSubscription.unsubscribe();\r\n    if (!unsubscribed) {\r\n      alert(failureUnsubscribeMessage);\r\n      return;\r\n    }\r\n    alert(successUnsubscribeMessage);\r\n  } catch (error) {\r\n    alert(failureUnsubscribeMessage);\r\n    console.error('unsubscribe: error:', error);\r\n  }\r\n}\r\n\r\nwindow.subscribeNotif = subscribe;\r\n","import routes from \"../routes/routes\";\nimport { getActiveRoute } from \"../routes/url-parser\";\nimport 'leaflet/dist/leaflet.css';\nimport { isServiceWorkerAvailable } from \"../utils/index\";\nimport {\n  isCurrentPushSubscriptionAvailable,\n  subscribe,\n  unsubscribe,\n} from \"../utils/notification-helper\";\n\nclass App {\n  #content = null;\n  #drawerButton = null;\n  #navigationDrawer = null;\n  #notificationButton = null;\n\n  constructor({ navigationDrawer, drawerButton, content }) {\n    this.#content = content;\n    this.#drawerButton = drawerButton;\n    this.#navigationDrawer = navigationDrawer;\n    this.#setupDrawer();\n    this.#setupInstallPrompt();\n    this.#registerServiceWorker(); \n  }\n\n  #setupDrawer() {\n    this.#drawerButton.addEventListener(\"click\", () => {\n      this.#navigationDrawer.classList.toggle(\"open\");\n    });\n    document.body.addEventListener(\"click\", (event) => {\n      if (\n        !this.#navigationDrawer.contains(event.target) &&\n        !this.#drawerButton.contains(event.target)\n      ) {\n        this.#navigationDrawer.classList.remove(\"open\");\n      }\n      this.#navigationDrawer.querySelectorAll(\"a\").forEach((link) => {\n        if (link.contains(event.target)) {\n          this.#navigationDrawer.classList.remove(\"open\");\n        }\n      });\n    });\n  }\n\n  // üîß Tambahan untuk register SW\n  #registerServiceWorker() {\n    if (\"serviceWorker\" in navigator) {\n      window.addEventListener(\"load\", () => {\n        navigator.serviceWorker\n          .register(\"/sw.js\")\n          .then(() => console.log(\"‚úÖ Service Worker registered\"))\n          .catch((err) =>\n            console.error(\"‚ùå SW registration failed:\", err)\n          );\n      });\n    }\n  }\n\n  #setupInstallPrompt() {\n    let deferredPrompt;\n    window.addEventListener(\"beforeinstallprompt\", (e) => {\n      e.preventDefault();\n      deferredPrompt = e;\n\n      if (document.getElementById(\"install-app-btn\")) return;\n\n      const installBtn = document.createElement(\"button\");\n      installBtn.id = \"install-app-btn\";\n      installBtn.textContent = \"üì± Install App\";\n      installBtn.style.cssText = `\n        position: fixed;\n        bottom: 20px;\n        right: 20px;\n        padding: 15px 25px;\n        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\n        color: white;\n        border: none;\n        border-radius: 25px;\n        font-weight: bold;\n        cursor: pointer;\n        box-shadow: 0 4px 15px rgba(79, 172, 254, 0.4);\n        z-index: 9999;\n        transition: transform 0.2s;\n      `;\n\n      installBtn.addEventListener(\"mouseover\", () => {\n        installBtn.style.transform = \"scale(1.05)\";\n      });\n\n      installBtn.addEventListener(\"mouseout\", () => {\n        installBtn.style.transform = \"scale(1)\";\n      });\n\n      installBtn.addEventListener(\"click\", async () => {\n        deferredPrompt.prompt();\n        const { outcome } = await deferredPrompt.userChoice;\n        if (outcome === \"accepted\") {\n          console.log(\"‚úÖ User accepted the install prompt\");\n          installBtn.remove();\n        } else {\n          console.log(\"‚ùå User dismissed the install prompt\");\n        }\n        deferredPrompt = null;\n      });\n\n      document.body.appendChild(installBtn);\n    });\n\n    window.addEventListener(\"appinstalled\", () => {\n      document.getElementById(\"install-app-btn\")?.remove();\n      console.log(\"‚úÖ PWA was installed\");\n    });\n  }\n\n  async renderPage() {\n    console.log(\"Rendering page...\");\n    const url = getActiveRoute();\n    const page = routes[url];\n\n    if (!page) {\n      console.error(\"Page not found for route:\", url);\n      return;\n    }\n\n    const token = localStorage.getItem(\"token\");\n    const navList = document.getElementById(\"nav-list\");\n\n    if (token) {\n      navList.innerHTML = `\n        <li><a href=\"#/home\">Home</a></li>\n        <li><a href=\"#/add\">Add Story</a></li>\n        <li><a href=\"#/favorite\">Favorite</a></li>\n        <li><a href=\"#/\" id=\"logout\">Logout</a></li>\n      `;\n      setTimeout(() => {\n        document.getElementById(\"logout\").addEventListener(\"click\", (e) => {\n          e.preventDefault();\n          localStorage.removeItem(\"token\");\n          localStorage.removeItem(\"name\");\n          alert(\"Logout berhasil!\");\n          location.hash = \"#/auth\";\n        });\n      }, 0);\n    } else {\n      navList.innerHTML = `\n        <li><a href=\"#/home\" id=\"home-link\">Home</a></li>\n        <li><a href=\"#/add\" id=\"add-link\">Add Story</a></li>\n        <li><a href=\"#/auth\">Login</a></li>\n      `;\n      setTimeout(() => {\n        document.getElementById(\"home-link\")?.addEventListener(\"click\", (e) => {\n          e.preventDefault();\n          alert(\"Silakan login dulu!\");\n          location.hash = \"#/auth\";\n        });\n        document.getElementById(\"add-link\")?.addEventListener(\"click\", (e) => {\n          e.preventDefault();\n          alert(\"Silakan login dulu!\");\n          location.hash = \"#/auth\";\n        });\n      }, 0);\n    }\n\n    const renderContent = async () => {\n      this.#content.innerHTML = await page.render();\n      await page.afterRender();\n      if (isServiceWorkerAvailable() && token) {\n        this.#setupPushNotification();\n      }\n    };\n\n    if (document.startViewTransition) {\n      document.startViewTransition(renderContent);\n    } else {\n      this.#content.style.opacity = \"0\";\n      setTimeout(async () => {\n        await renderContent();\n        this.#content.style.opacity = \"1\";\n      }, 300);\n    }\n  }\n\n  async #setupPushNotification() {\n    if (this.#notificationButton) {\n      this.#notificationButton.remove();\n      this.#notificationButton = null;\n    }\n\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      console.log(\"‚úÖ Service Worker is ready\");\n\n      const isSubscribed = await isCurrentPushSubscriptionAvailable();\n\n      this.#notificationButton = document.createElement(\"button\");\n      this.#notificationButton.id = \"notification-toggle-btn\";\n      this.#notificationButton.style.cssText = `\n        position: fixed;\n        bottom: 80px;\n        right: 20px;\n        padding: 15px 25px;\n        background: ${\n          isSubscribed\n            ? \"linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)\"\n            : \"linear-gradient(135deg, #2ecc71 0%, #27ae60 100%)\"\n        };\n        color: white;\n        border: none;\n        border-radius: 25px;\n        font-weight: bold;\n        cursor: pointer;\n        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);\n        z-index: 9998;\n        transition: all 0.3s;\n        font-size: 14px;\n      `;\n\n      this.#notificationButton.textContent = isSubscribed\n        ? \"üîï Unsubscribe Notification\"\n        : \"üîî Subscribe Notification\";\n\n      this.#notificationButton.addEventListener(\"mouseover\", () => {\n        this.#notificationButton.style.transform = \"scale(1.05)\";\n      });\n\n      this.#notificationButton.addEventListener(\"mouseout\", () => {\n        this.#notificationButton.style.transform = \"scale(1)\";\n      });\n\n      this.#notificationButton.addEventListener(\"click\", async () => {\n        this.#notificationButton.disabled = true;\n        this.#notificationButton.textContent = \"‚è≥ Processing...\";\n        try {\n          if (isSubscribed) {\n            await unsubscribe();\n          } else {\n            await subscribe();\n          }\n          await this.#setupPushNotification();\n        } catch (error) {\n          console.error(\"Error toggling notification:\", error);\n          alert(\"Failed to toggle notification: \" + error.message);\n          this.#notificationButton.disabled = false;\n        }\n      });\n\n      document.body.appendChild(this.#notificationButton);\n    } catch (error) {\n      console.error(\"‚ùå Service Worker not ready:\", error);\n    }\n  }\n}\n\nexport default App;\n","import '../styles/styles.css';\nimport App from './pages/app';\nimport { registerServiceWorker } from './utils/index';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\nlet app;\n\ndocument.addEventListener('DOMContentLoaded', async () => {\n  console.log('App initializing...');\n  \n  // Initialize app\n  app = new App({\n    content: document.querySelector('#main-content'),\n    drawerButton: document.querySelector('#drawer-button'),\n    navigationDrawer: document.querySelector('#navigation-drawer'),\n  });\n\n  // Register service worker first\n  await registerServiceWorker();\n\n  // Set initial route\n  if (!location.hash || location.hash === '#/') {\n    const token = localStorage.getItem('token');\n    location.hash = token ? '#/home' : '#/auth';\n  }\n\n  // Render initial page\n  await app.renderPage();\n\n  // Listen for hash changes\n  window.addEventListener('hashchange', async () => {\n    console.log('Hash changed to:', location.hash);\n    await app.renderPage();\n  });\n\n  console.log('App initialized successfully');\n});"],"names":["CONFIG","ENDPOINTS","getAuthHeader","token","register","user","data","login","getStories","addStory","story","formData","subscribePushNotification","endpoint","p256dh","auth","fetchResponse","unsubscribePushNotification","map","markers","initMap","containerId","stories","L","satellite","addMarkers","marker","filterMarkers","query","validateForm","isValid","sleep","time","resolve","isServiceWorkerAvailable","registerServiceWorker","registrations","registration","newWorker","error","hideOfflineIndicator","showOfflineIndicator","indicator","style","instanceOfAny","object","constructors","c","idbProxyableTypes","cursorAdvanceMethods","getIdbProxyableTypes","getCursorAdvanceMethods","transactionDoneMap","transformCache","reverseTransformCache","promisifyRequest","request","promise","reject","unlisten","success","wrap","cacheDonePromiseForTransaction","tx","done","complete","idbProxyTraps","target","prop","receiver","value","replaceTraps","callback","wrapFunction","func","args","unwrap","transformCachableValue","newValue","openDB","name","version","blocked","upgrade","blocking","terminated","openPromise","event","db","readMethods","writeMethods","cachedMethods","getMethod","targetFuncName","useIndex","isWrite","method","storeName","oldTraps","advanceMethodProps","methodMap","advanceResults","ittrProxiedCursorToOriginalProxy","cursorIteratorTraps","cachedFunc","iterate","cursor","proxiedCursor","isIteratorProp","DATABASE_NAME","DATABASE_VERSION","STORIES_STORE","PENDING_STORE","dbPromise","database","storyStore","Database","id","allStories","lowerQuery","_a","_b","sortBy","order","a","b","aVal","bVal","startDate","endDate","start","end","storyDate","storyData","pendingStory","tempId","HomePage","__privateAdd","_HomePage_instances","storyList","savedStories","savedIds","s","e","btn","button","__privateMethod","showToast_fn","message","type","toast","SyncHelper","_SyncHelper_instances","_isSyncing","_syncListeners","setupEventListeners_fn","notifyListeners_fn","__privateGet","__privateSet","pendingStories","results","photoFile","base64ToFile_fn","finalResult","showSyncNotification_fn","cb","showOnlineNotification_fn","showOfflineNotification_fn","base64String","filename","arr","mime","bstr","n","u8arr","notification","removeIndicator","result","syncHelper","AddPage","_AddPage_instances","lat","lon","newLat","newLon","form","description","photo","submitButton","sendPushNotification_fn","reader","stream","modal","video","buttonContainer","captureBtn","cancelBtn","canvas","blob","file","dt","track","err","storyName","AuthPage","isLogin","formTitle","toggleLink","updateForm","handleSubmit","email","password","FavoritePage","_FavoritePage_instances","_allStories","_filteredStories","_currentSort","_currentOrder","loadStories_fn","renderStats_fn","renderStories_fn","initializeMap_fn","showError_fn","container","storiesHTML","attachStoryEventListeners_fn","deleteStory_fn","showSuccess_fn","applyFilters_fn","orderSelect","applySort_fn","clearAllFavorites_fn","count","pendingCount","statsElement","routes","extractPathnameSegments","path","splitUrl","constructRouteFromSegments","pathSegments","pathname","getActivePathname","getActiveRoute","urlSegments","urlBase64ToUint8Array","padding","base64","rawData","outputArray","VAPID_PUBLIC_KEY","isNotificationAvailable","isNotificationGranted","requestNotificationPermission","status","getPushSubscription","isCurrentPushSubscriptionAvailable","subscribe","failureSubscribeMessage","successSubscribeMessage","pushSubscription","keys","response","unsubscribe","failureUnsubscribeMessage","successUnsubscribeMessage","App","navigationDrawer","drawerButton","content","_App_instances","_content","_drawerButton","_navigationDrawer","_notificationButton","setupDrawer_fn","setupInstallPrompt_fn","registerServiceWorker_fn","url","page","navList","renderContent","setupPushNotification_fn","link","deferredPrompt","installBtn","outcome","isSubscribed","app"],"mappings":"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","x_google_ignoreList":[5]}